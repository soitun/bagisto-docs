import{_ as s,a as i,o as t,ag as a}from"./chunks/framework.C2qfZH9T.js";const g=JSON.parse('{"title":"🔒 Best Security Practices","description":"","frontmatter":{},"headers":[],"relativePath":"getting-started/best-security-practice.md","filePath":"getting-started/best-security-practice.md","lastUpdated":1757593917000}'),n={name:"getting-started/best-security-practice.md"};function r(o,e,l,p,c,h){return t(),i("div",null,e[0]||(e[0]=[a(`<h1 id="🔒-best-security-practices" tabindex="-1">🔒 Best Security Practices <a class="header-anchor" href="#🔒-best-security-practices" aria-label="Permalink to &quot;🔒 Best Security Practices&quot;">​</a></h1><p>Securing your Bagisto installation is critical to protecting your business, customer data, and reputation. This guide outlines essential security practices you should follow to minimize vulnerabilities and defend against common threats. By proactively implementing these measures, you can significantly reduce the risk of unauthorized access and data breaches.</p><h2 id="🔄-software-updates" tabindex="-1">🔄 Software Updates <a class="header-anchor" href="#🔄-software-updates" aria-label="Permalink to &quot;🔄 Software Updates&quot;">​</a></h2><p>To ensure the security of your system, follow these best practices:</p><ul><li>Use HTTPS to encrypt communication. Google now considers HTTPS as a ranking factor.</li><li>Keep all software on the server up-to-date, including Bagisto, the database, Adminer/phpMyAdmin, Apache, Redis, etc.</li><li>Regularly update the server operating system to apply available security patches.</li><li>Manage files only through secure communication protocols like SSH, SFTP, or HTTPS. Disable FTP.</li><li>Use the <strong><code>.htaccess</code></strong> file to protect system files when using the Apache web server.</li><li>Disable unused ports and stop unnecessary services running on the server.</li><li>Restrict access to the admin panel by allowing only specific IP addresses and enforcing two-factor authentication for admin logins.</li><li>Ensure the use of strong and unique passwords.</li><li>Configure and update the firewall properly to secure the connection between payment card data and the public network.</li></ul><h2 id="🚫-limiting-error-messages" tabindex="-1">🚫 Limiting Error Messages <a class="header-anchor" href="#🚫-limiting-error-messages" aria-label="Permalink to &quot;🚫 Limiting Error Messages&quot;">​</a></h2><p>To limit the exposure of sensitive information in error messages, follow these steps:</p><ul><li>Edit your Apache configuration file to avoid displaying server and operating system details.</li><li>Set <strong><code>ServerSignature</code></strong> to <strong><code>Off</code></strong> (by default, it is <strong><code>On</code></strong>).</li><li>Add <strong><code>ServerTokens Prod</code></strong> to display only Apache as the product.</li></ul><h2 id="🔐-limiting-admin-access" tabindex="-1">🔐 Limiting Admin Access <a class="header-anchor" href="#🔐-limiting-admin-access" aria-label="Permalink to &quot;🔐 Limiting Admin Access&quot;">​</a></h2><p>To restrict access to the admin area, modify the <strong><code>.htaccess</code></strong> file with the following code:</p><div class="language-apache vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RewriteEngine</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> On</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RewriteCond</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> %{REQUEST_URI}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .*/admin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RewriteCond</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> %{REMOTE_ADDR}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> !=&lt;IP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> address&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RewriteCond</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> %{REMOTE_ADDR}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> !=&lt;IP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> address&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RewriteRule</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;"> ^(.*)$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [R=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">403</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,L]</span></span></code></pre></div><p>Ensure that there are no accessible development leftovers on the server, such as &quot;log files,&quot; &quot;.git directories,&quot; &quot;database dumps,&quot; or &quot;zip files.&quot;</p><h2 id="📁-restricting-unnecessary-files" tabindex="-1">📁 Restricting Unnecessary Files <a class="header-anchor" href="#📁-restricting-unnecessary-files" aria-label="Permalink to &quot;📁 Restricting Unnecessary Files&quot;">​</a></h2><p>To restrict access to unnecessary files, add the following code to your <strong><code>.htaccess</code></strong> file:</p><div class="language-apache vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FilesMatch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\\.(git|zip|tar|sql)$&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    Require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all denied</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FilesMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Consider using a Web Application Firewall (WAF) to analyze traffic and detect suspicious patterns, such as credit card information being sent to attackers. Additionally, restrict public access to only ports 80 (HTTP) and 443 (HTTPS), while blocking other ports.</p><h2 id="🚫-restricting-php-execution-in-storage" tabindex="-1">🚫 Restricting PHP Execution in Storage <a class="header-anchor" href="#🚫-restricting-php-execution-in-storage" aria-label="Permalink to &quot;🚫 Restricting PHP Execution in Storage&quot;">​</a></h2><p>To restrict PHP execution inside the storage directory, modify your Apache configuration file:</p><div class="language-apache vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~/www/bagisto/public/storage/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FilesMatch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\\.php$&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        Require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all denied</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FilesMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    php_flag</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> engine</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> off</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Don&#39;t forget to restart Apache after making these changes.</p><h2 id="🛡️-server-hardening" tabindex="-1">🛡️ Server Hardening <a class="header-anchor" href="#🛡️-server-hardening" aria-label="Permalink to &quot;🛡️ Server Hardening&quot;">​</a></h2><p>Take the following measures to harden your server:</p><ul><li>Use the <strong><code>mod_security</code></strong> module to detect and prevent intrusions.</li><li>Implement the <strong><code>mod_passive</code></strong> module to prevent brute force attacks.</li><li>Allow only specific users to log in.</li><li>Disable login for users with empty passwords.</li><li>Review and configure iptable rules to prevent unauthorized access and activity.</li><li>Regularly back up important files and store them remotely in a secure environment.</li></ul><h2 id="🔑-strong-passwords" tabindex="-1">🔑 Strong Passwords <a class="header-anchor" href="#🔑-strong-passwords" aria-label="Permalink to &quot;🔑 Strong Passwords&quot;">​</a></h2><p>Ensure the use of strong and unique passwords and encourage periodic password changes. You can use a password generator tool (<a href="https://passwords-generator.org/" target="_blank" rel="noreferrer">Password Generator</a>) to create strong passwords. Limit access to the Bagisto admin panel by updating the whitelist with authorized IP addresses.</p><h2 id="🌐-implementation-of-http-security-headers" tabindex="-1">🌐 Implementation of HTTP Security Headers <a class="header-anchor" href="#🌐-implementation-of-http-security-headers" aria-label="Permalink to &quot;🌐 Implementation of HTTP Security Headers&quot;">​</a></h2><p>Implementing the following HTTP security headers enhances web security:</p><h3 id="🔒-http-strict-transport-security-hsts" tabindex="-1">🔒 HTTP Strict Transport Security (HSTS) <a class="header-anchor" href="#🔒-http-strict-transport-security-hsts" aria-label="Permalink to &quot;🔒 HTTP Strict Transport Security (HSTS)&quot;">​</a></h3><p>Set the <strong><code>Strict-Transport-Security</code></strong> response header to instruct the browser to access the application only using HTTPS:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Strict-Transport-Security: max-age=&lt;expire-time&gt;</span></span></code></pre></div><h3 id="⚔️-cross-site-scripting-protection-x-xss-protection" tabindex="-1">⚔️ Cross-Site Scripting Protection (X-XSS-Protection) <a class="header-anchor" href="#⚔️-cross-site-scripting-protection-x-xss-protection" aria-label="Permalink to &quot;⚔️ Cross-Site Scripting Protection (X-XSS-Protection)&quot;">​</a></h3><p>Set the <strong><code>X-XSS-Protection</code></strong> response header to enable browsers to detect and prevent cross-site scripting (XSS) attacks:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>X-XSS-Protection: 1; mode=block</span></span></code></pre></div><h3 id="🖼️-x-frame-options" tabindex="-1">🖼️ X-Frame-Options <a class="header-anchor" href="#🖼️-x-frame-options" aria-label="Permalink to &quot;🖼️ X-Frame-Options&quot;">​</a></h3><p>The <strong><code>X-Frame-Options</code></strong> response header protects applications against clickjacking attacks. It specifies whether the content can be displayed within frames:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>X-Frame-Options: deny</span></span></code></pre></div><h3 id="📄-x-content-type-options" tabindex="-1">📄 X-Content-Type-Options <a class="header-anchor" href="#📄-x-content-type-options" aria-label="Permalink to &quot;📄 X-Content-Type-Options&quot;">​</a></h3><p>The <strong><code>X-Content-Type-Options</code></strong> response header forces the browser to disable MIME sniffing, preventing MIME sniffing vulnerabilities:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>X-Content-Type-Options: nosniff</span></span></code></pre></div><h3 id="🛡️-content-security-policy-csp" tabindex="-1">🛡️ Content Security Policy (CSP) <a class="header-anchor" href="#🛡️-content-security-policy-csp" aria-label="Permalink to &quot;🛡️ Content Security Policy (CSP)&quot;">​</a></h3><p>Implement a Content Security Policy (CSP) response header to control which resources can be loaded in users&#39; browsers. CSP helps detect and mitigate attacks such as XSS and clickjacking.</p><h3 id="📊-continuous-logging-and-monitoring" tabindex="-1">📊 Continuous Logging and Monitoring <a class="header-anchor" href="#📊-continuous-logging-and-monitoring" aria-label="Permalink to &quot;📊 Continuous Logging and Monitoring&quot;">​</a></h3><p>Maintain continuous logging and monitoring of all network access and cardholder data activities. Keep an eye out for large volume orders of a single item from new customers, or a series of orders shipped to the same address but using different payment methods.</p><p>By implementing these best security practices, you can enhance the security of your system and protect it from potential threats.</p>`,44)]))}const u=s(n,[["render",r]]);export{g as __pageData,u as default};
